---
import Layout from '../../layouts/Layout.astro';
import Seo from '../../components/Seo.astro';

import fs from "node:fs/promises";
import path from "node:path";

const PER_PAGE = 5;
const JSON_PATH = path.join(process.cwd(), "public", "articles_enriched.json");

let allArticles = [];
try {
  const raw = await fs.readFile(JSON_PATH, "utf-8");
  const parsed = JSON.parse(raw);
  allArticles = Array.isArray(parsed) ? parsed : [];
} catch {
  allArticles = [];
}

allArticles = allArticles
  .filter((article) => article?.category === "noticia")
  .sort((a, b) => new Date(b?.date || 0) - new Date(a?.date || 0));

const initialArticles = allArticles.slice(0, PER_PAGE);
---

<Seo 
  title="Revistas Cient√≠ficas | FuturoCient√≠fico"
  description="Explora art√≠culos cient√≠ficos recientes, revistas populares, centros de investigaci√≥n y c√≥mo entender publicaciones cient√≠ficas."
  site="https://futurocientifico.vercel.app/revistas"
/>

<Layout>
  <section class="bg-purple-50 p-6 rounded-xl shadow-sm text-center mb-8">
    <h1 class="text-3xl font-bold text-purple-800">Revistas Cient√≠ficas</h1>
    <p class="mt-2 text-purple-700 text-sm max-w-xl mx-auto">
      Un espacio para descubrir art√≠culos actualizados, explorar centros de investigaci√≥n y aprender c√≥mo se construye el conocimiento cient√≠fico.
    </p>
  </section>

  <!-- √öltimos art√≠culos (alternados) -->
  <section class="bg-purple-50 py-6 px-4 max-w-6xl mx-auto rounded-xl shadow-sm mb-8">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-start" id="articles-block">
      <div id="article-info" class="space-y-4">
        <h2 class="text-2xl font-bold text-purple-900">üß™ Art√≠culos recientes</h2>
          <p class="text-purple-700">
            Esta secci√≥n presenta noticias cient√≠ficas actualizadas a diario, recopiladas autom√°ticamente de fuentes fiables como 
            <strong>arXiv</strong>, <strong>Nature</strong>, <strong>Science.org</strong>, <strong>PubMed</strong>, <strong>ScienceDaily</strong>, <strong>Phys.org</strong>, <strong>PNAS</strong>, <strong>PLOS ONE</strong>, <strong>Science News</strong>, <strong>Science News Explores</strong>, <strong>NASA</strong>, <strong>ESA</strong>, <strong>CERN</strong>, <strong>NIH</strong> y <strong>NCI</strong>, as√≠ como medios en espa√±ol como 
            <strong>CNIO</strong>, <strong>CNIC</strong>, <strong>AEMET</strong>, <strong>IAC</strong>, <strong>ISCIII</strong> e <strong>IEO</strong>.
          </p>
      </div>

      <!-- Render inicial (SSG/SSR) -->
      {initialArticles.map((article) => {
        const title = article?.title_es ?? article?.title ?? "Art√≠culo cient√≠fico";
        const source = article?.source ?? "Fuente";
        const date = article?.date ? new Date(article.date).toLocaleDateString() : "";
        const href = article?.pdf || article?.url || "#";

        return (
          <div class="bg-white rounded-xl p-4 shadow-md">
            <h3 class="text-xl font-semibold text-blue-900">{title}</h3>
            <p class="text-gray-600 text-sm mb-2">{source}{date ? ` | ${date}` : ""}</p>

            <a
              href={href}
              target="_blank"
              rel="noopener noreferrer"
              class="text-blue-700 hover:underline block mt-2"
            >
              Leer PDF
            </a>
          </div>
        );
      })}
    </div>

    <div class="flex justify-center mt-6">
      <button id="loadMore" class="bg-purple-700 text-white px-4 py-2 rounded hover:bg-purple-800 hidden">
        Ver m√°s noticias
      </button>
    </div>

    <script type="module">
      const grid = document.querySelector('#articles-block');
      const button = document.querySelector('#loadMore');

      const perPage = 5;
      let currentPage = 2; // üëà ya hay 1¬™ p√°gina renderizada en HTML
      let allArticles = [];

      fetch('/articles_enriched.json')
        .then(res => res.json())
        .then(data => {
          allArticles = (Array.isArray(data) ? data : [])
            .filter(article => article?.category === 'noticia')
            .sort((a, b) => new Date(b?.date || 0) - new Date(a?.date || 0));

          if (allArticles.length > perPage) button.classList.remove('hidden');
        });

      function renderPage() {
        const start = (currentPage - 1) * perPage;
        const end = start + perPage;
        const currentArticles = allArticles.slice(start, end);

        currentArticles.forEach(article => {
          ;

          const title = article.title_es || article.title || 'Art√≠culo cient√≠fico';
          const date = article.date ? new Date(article.date).toLocaleDateString() : '';
          const href = article.pdf || article.url || '#';

          const html = `
            <div class='bg-white rounded-xl p-4 shadow-md'>
              <h3 class='text-xl font-semibold text-blue-900'>${title}</h3>
              <p class='text-gray-600 text-sm mb-2'>${article.source || 'Fuente'}${date ? ` | ${date}` : ''}</p>    
              <a href='${href}' target='_blank' rel='noopener noreferrer' class='text-blue-700 hover:underline block mt-2'>Leer PDF</a>
            </div>`;
          grid.insertAdjacentHTML('beforeend', html);
        });

        currentPage++;

        if ((currentPage - 1) * perPage >= allArticles.length) button.classList.add('hidden');
      }

      button.addEventListener('click', renderPage);
    </script>
  </section>

  <!-- Grid de bloques informativos -->
  <section class="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-8">
<div class="bg-purple-50 py-6 px-4 rounded-xl shadow-sm">
  <h2 class="text-2xl font-bold text-purple-900 mb-4">
    üì∞ Revistas cient√≠ficas en quioscos y bibliotecas
  </h2>
  <ul class="list-disc pl-6 text-purple-700 space-y-2">
    <!-- Sustituye a 'Investigaci√≥n y Ciencia' (ces√≥ en 2023) -->
    <li>
      <a
        href="https://metode.es/"
        class="underline font-semibold focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-500"
        target="_blank" rel="noopener noreferrer"
        aria-label="Revista M√®tode, Universidad de Val√®ncia (abre en pesta√±a nueva)"
      >M√®tode (Universitat de Val√®ncia) ‚Äì trimestral</a>
    </li>

    <li>
      <a
        href="https://www.muyinteresante.com/"
        class="underline font-semibold focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-500"
        target="_blank" rel="noopener noreferrer"
        aria-label="Muy Interesante, sitio oficial (abre en pesta√±a nueva)"
      >Muy Interesante</a>
    </li>

    <li>
      <a
        href="https://www.nationalgeographic.com.es/"
        class="underline font-semibold focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-500"
        target="_blank" rel="noopener noreferrer"
        aria-label="National Geographic Espa√±a (abre en pesta√±a nueva)"
      >National Geographic (Espa√±a)</a>
      <span class="ml-1 text-sm text-purple-600">(suscripci√≥n/venta en quiosco v√≠a RBA)</span>
    </li>

    <li>
      <a
        href="https://quo.eldiario.es/"
        class="underline font-semibold focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-500"
        target="_blank" rel="noopener noreferrer"
        aria-label="Quo en eldiario.es (abre en pesta√±a nueva)"
      >Quo (edici√≥n digital)</a>
    </li>

    <li>
      <a
        href="https://principia.io/"
        class="underline font-semibold focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-500"
        target="_blank" rel="noopener noreferrer"
        aria-label="Principia, ciencia y arte (abre en pesta√±a nueva)"
      >Principia (magazine + online)</a>
    </li>
  </ul>
</div>

<div class="bg-purple-50 py-6 px-4 rounded-xl shadow-sm">
  <h2 class="text-2xl font-bold text-purple-900 mb-4">
    üèõÔ∏è Publicaciones de centros de investigaci√≥n
  </h2>
  <ul class="list-disc pl-6 text-purple-700 space-y-2">
    <li>
      <a
        href="https://revistas.csic.es/"
        class="underline font-semibold focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-500"
        target="_blank" rel="noopener noreferrer"
        aria-label="Revistas electr√≥nicas del CSIC (abre en pesta√±a nueva)"
      >CSIC ‚Äì Revistas electr√≥nicas en acceso abierto</a>
    </li>
    <li>
      <a
        href="https://www.cnio.es/investigacion-e-innovacion/publicaciones-cientificas/"
        class="underline font-semibold focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-500"
        target="_blank" rel="noopener noreferrer"
        aria-label="Publicaciones cient√≠ficas del CNIO (abre en pesta√±a nueva)"
      >CNIO ‚Äì Publicaciones cient√≠ficas</a>
    </li>
    <li>
      <a
        href="https://www.cnic.es/es/investigacion/noticias"
        class="underline font-semibold focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-500"
        target="_blank" rel="noopener noreferrer"
        aria-label="Publicaciones del CNIC (secci√≥n del ISCIII, abre en pesta√±a nueva)"
      >CNIC ‚Äì Publicaciones cient√≠ficas</a>
    </li>
    <li>
      <a
        href="https://www.iac.es/es/ciencia-y-tecnologia/publicaciones"
        class="underline font-semibold focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-500"
        target="_blank" rel="noopener noreferrer"
        aria-label="Base de datos de publicaciones del IAC (abre en pesta√±a nueva)"
      >IAC ‚Äì Base de datos de publicaciones cient√≠ficas</a>
    </li>
    <li>
      <a
        href="https://www.isciii.es/divulgacion"
        class="underline font-semibold focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-500"
        target="_blank" rel="noopener noreferrer"
        aria-label="Art√≠culos de divulgaci√≥n cient√≠fica del ISCIII (abre en pesta√±a nueva)"
      >ISCIII ‚Äì Art√≠culos de divulgaci√≥n cient√≠fica</a>
    </li>
    <li>
      <a
        href="https://www.inta.es/descubre-y-aprende/es/"
        class="underline font-semibold focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-500"
        target="_blank" rel="noopener noreferrer"
        aria-label="Informaci√≥n sobre Ediciones INTA (Wikipedia, abre en pesta√±a nueva)"
      >INTA ‚Äì Ediciones (revistas y libros)</a>
    </li>
    <li>
      <a
        href="https://www.idibaps.org/"
        class="underline font-semibold focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-500"
        target="_blank" rel="noopener noreferrer"
        aria-label="P√°gina principal del IDIBAPS (abre en pesta√±a nueva)"
      >IDIBAPS ‚Äì Centro de investigaci√≥n biom√©dica</a>
    </li>
  </ul>
</div>

    <div class="bg-purple-50 py-6 px-4 rounded-xl shadow-sm">
      <h2 class="text-2xl font-bold text-purple-900 mb-4">üîç C√≥mo encontrar art√≠culos cient√≠ficos fiables</h2>
      <ul class="list-disc pl-6 text-purple-700">
        <li><a href="https://scholar.google.es" class="underline font-semibold" target="_blank" rel="noopener noreferrer">Google Scholar</a></li>
        <li><a href="https://pubmed.ncbi.nlm.nih.gov" class="underline font-semibold" target="_blank" rel="noopener noreferrer">PubMed</a></li>
        <li><a href="https://doaj.org" class="underline font-semibold" target="_blank" rel="noopener noreferrer">DOAJ</a></li>
        <li><strong>Repositorios universitarios</strong>: tesis y art√≠culos en acceso abierto.</li>
        <li><strong>Evita fuentes no verificadas</strong>: busca publicaciones peer-reviewed.</li>
      </ul>
    </div>
<div class="bg-purple-50 py-6 px-4 rounded-xl shadow-sm">
  <h2 class="text-2xl font-bold text-purple-900 mb-4">
    üìñ Herramientas para interpretar publicaciones cient√≠ficas
  </h2>
  <ul class="list-disc pl-6 text-purple-700 space-y-2">
    <li>
      <a
        href="https://undsci.berkeley.edu/glossary/"
        class="underline focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-500"
        target="_blank" rel="noopener noreferrer"
        aria-label="Glosario de t√©rminos cient√≠ficos de Understanding Science (abre en pesta√±a nueva)"
      >Glosario de t√©rminos cient√≠ficos ‚Äì Understanding Science (UC Berkeley)</a>
    </li>
    <li>
      <a
        href="https://www.cochrane.org/es/evidence"
        class="underline focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-500"
        target="_blank" rel="noopener noreferrer"
        aria-label="Cochrane res√∫menes en lenguaje sencillo en espa√±ol (abre en pesta√±a nueva)"
      >Cochrane ‚Äì Res√∫menes en lenguaje sencillo (ES)</a>
    </li>
    <li>
      <a
        href="https://es.khanacademy.org/math/cc-sixth-grade-math/cc-6th-data-statistics/dot-plot/e/analyzing-with-dot-plots"
        class="underline focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-500"
        target="_blank" rel="noopener noreferrer"
        aria-label="Khan Academy en espa√±ol: c√≥mo interpretar gr√°ficos (abre en pesta√±a nueva)"
      >Khan Academy (ES) ‚Äì C√≥mo interpretar gr√°ficos</a>
    </li>
    <li>
      <a
        href="https://www.quantamagazine.org/tag/explainers/"
        class="underline focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-500"
        target="_blank" rel="noopener noreferrer"
        aria-label="Quanta Magazine explicadores cient√≠ficos (abre en pesta√±a nueva)"
      >Quanta Magazine ‚Äì Explicadores de ciencia</a>
    </li>
    <li>
      <a
        href="https://www.agenciasinc.es/"
        class="underline focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-500"
        target="_blank" rel="noopener noreferrer"
        aria-label="Agencia SINC portal de noticias cient√≠ficas en espa√±ol (abre en pesta√±a nueva)"
      >Agencia SINC ‚Äì Ciencia en espa√±ol</a>
    </li>
    <li>
      <strong>Consejo:</strong> busca la secci√≥n de ‚ÄúDiscusi√≥n‚Äù o ‚ÄúConclusiones‚Äù y verifica si el art√≠culo incluye un
      <em>resumen en lenguaje sencillo</em>.
    </li>
  </ul>
</div>

  </section>

  <!-- CTA final -->
  <section class="bg-purple-100 mt-12 py-6 rounded-xl shadow-sm">
    <div class="max-w-4xl mx-auto px-4 text-center">
      <h2 class="text-xl font-bold text-purple-800 mb-4">¬øQuieres aprender a leer ciencia?</h2>
      <p class="text-purple-700 mb-4">Explora nuestras secciones de formaci√≥n, recursos y ciencia ciudadana para descubrir m√°s herramientas y contenidos.</p>
      <div class="flex justify-center gap-4 flex-wrap">
        <a href="/formacion" class="bg-purple-700 hover:bg-purple-800 text-white py-2 px-4 rounded-xl shadow">Formaci√≥n</a>
        <a href="/recursos" class="bg-purple-700 hover:bg-purple-800 text-white py-2 px-4 rounded-xl shadow">Recursos</a>
        <a href="/recursos/ciencia-ciudadana" class="bg-purple-700 hover:bg-purple-800 text-white py-2 px-4 rounded-xl shadow">Ciencia Ciudadana</a>
      </div>
    </div>
  </section>

  <!-- Adsense -->
  <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2163450732409344"
     data-ad-slot="6134548917"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
  <script>
    if (typeof window !== "undefined") {
      if (window.adsbygoogle && Array.isArray(window.adsbygoogle)) {
        window.adsbygoogle.push({});
      } else {
        const interval = setInterval(() => {
          if (window.adsbygoogle && Array.isArray(window.adsbygoogle)) {
            window.adsbygoogle.push({});
            clearInterval(interval);
          }
        }, 300);
      }
    }
  </script>
</Layout>
