---
import Layout from '../layouts/Layout.astro';
---

<Layout>
  <div id="splash" class="fixed inset-0 bg-white flex items-center justify-center z-50">
    <img id="splash-avatar" src="/avatar-cientifico.png" alt="Avatar" class="w-32 h-32 animate-bounce" />
  </div>

  <script>
    const lastAvatar = localStorage.getItem('avatar') || 'cientifico';
    const nextAvatar = lastAvatar === 'cientifico' ? 'cientifica' : 'cientifico';
    document.getElementById('splash-avatar').src = `/avatar-${nextAvatar}.png`;
    localStorage.setItem('avatar', nextAvatar);

    setTimeout(() => {
      document.getElementById('splash').style.display = 'none';
    }, 3000);
  </script>

  <section class="bg-gradient-to-r from-blue-50 to-white p-6 rounded-xl shadow-sm text-center mb-8">
    <img src="/avatar.png" alt="Avatar" class="w-24 h-24 mx-auto mb-4" />
    <h1 class="text-3xl font-bold text-blue-800">FuturoCientífico</h1>
    <p class="mt-2 text-blue-700 text-sm max-w-xl mx-auto">
      Plataforma educativa y de divulgación para inspirar a los futuros científicos. Noticias, formación y recursos cada día.
    </p>
  </section>

  <section class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-10">
    <a href="/formacion" class="block p-4 bg-white rounded-xl shadow hover:shadow-md transition">
      <h2 class="text-lg font-semibold text-blue-800">Formación</h2>
      <p class="text-sm text-gray-600">Rutas académicas, consejos y orientación científica.</p>
    </a>
    <a href="/recursos" class="block p-4 bg-white rounded-xl shadow hover:shadow-md transition">
      <h2 class="text-lg font-semibold text-blue-800">Recursos</h2>
      <p class="text-sm text-gray-600">Herramientas, plataformas y enlaces educativos útiles.</p>
    </a>
    <a href="/apoya" class="block p-4 bg-white rounded-xl shadow hover:shadow-md transition">
      <h2 class="text-lg font-semibold text-blue-800">Apóyanos</h2>
      <p class="text-sm text-gray-600">Colabora para que sigamos creando contenido libre y diario.</p>
    </a>
  </section>

  <h2 class="text-xl font-bold text-blue-900 mb-4">Últimas noticias científicas</h2>
  <div id="articles" class="space-y-6"></div>

  <script type="module">
    const container = document.querySelector('#articles');
    fetch('/articles.json')
      .then(res => res.json())
      .then(data => {
        data.sort((a, b) => new Date(b.date) - new Date(a.date)).forEach(article => {
          container.innerHTML += `
            <article class="bg-white rounded-xl p-4 shadow-md">
              <h3 class="text-lg font-semibold text-blue-900">${article.title_es}</h3>
              <p class="text-sm text-gray-600">${article.source} | ${new Date(article.date).toLocaleDateString()}</p>
              <a href="${article.url}" target="_blank" class="text-blue-700 hover:underline mt-2 block">Leer más</a>
            </article>`;
        });
      });
  </script>
</Layout>
