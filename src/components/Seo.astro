---
type Alternate = { hreflang: string; href: string };

const {
  title = "FuturoCientífico",
  description = "Divulgación científica para todas las edades.",
  site, // compat: en tu proyecto lo usas como canonical absoluto
  canonical, // nuevo (opcional)
  lang = "es",
  robots = "index,follow",
  ogImage, // opcional
  alternates = [] as Alternate[], // opcional: [{ hreflang:"en", href:"https://..." }, ...]
} = Astro.props;

// Canonical final (prioridad: canonical > site > Astro.url.href)
const canonicalUrl = canonical ?? site ?? Astro.url.href;

// Imagen social: usa una existente (ajusta si tienes un og dedicado)
const ogImageUrl = ogImage ?? "/avatar-cientifico.webp";

// JSON-LD
const jsonLd = {
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "WebSite",
      "@id": `${new URL(canonicalUrl).origin}/#website`,
      "url": new URL(canonicalUrl).origin,
      "name": "FuturoCientífico",
      "inLanguage": lang
    },
    {
      "@type": "Organization",
      "@id": `${new URL(canonicalUrl).origin}/#organization`,
      "name": "FuturoCientífico",
      "url": new URL(canonicalUrl).origin,
      "logo": {
        "@type": "ImageObject",
        "url": new URL(ogImageUrl, new URL(canonicalUrl).origin).href
      }
    }
  ]
};
---

<title>{title}</title>
<meta name="description" content={description} />
<meta name="robots" content={robots} />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="canonical" href={canonicalUrl} />

{alternates?.length > 0 && alternates.map((a) => (
  <link rel="alternate" hreflang={a.hreflang} href={a.href} />
))}

<!-- Open Graph -->
<meta property="og:type" content="website" />
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
<meta property="og:url" content={canonicalUrl} />
<meta property="og:locale" content={lang === "es" ? "es_ES" : "en_US"} />
<meta property="og:image" content={ogImageUrl} />

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content={title} />
<meta name="twitter:description" content={description} />
<meta name="twitter:image" content={ogImageUrl} />

<script type="application/ld+json" is:inline>
  {JSON.stringify(jsonLd)}
</script>
